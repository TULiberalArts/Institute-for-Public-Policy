language: ruby
rvm:
- 2.2.5
env:
  global:
  - NOKOGIRI_USE_SYSTEM_LIBRARIES=true
sudo: false
branches:
  only:
  - master
install:
- bundle install
script:
- 'wget -O ./_data/news.csv $(bundle exec yaml get news-feed -F=_config.yml) || :'
- 'wget -O ./_data/events.csv $(bundle exec yaml get events-feed -F=_config.yml) ||
  :'
- 'wget -O ./_data/profiles.csv $(bundle exec yaml get faculty-feed -F=_config.yml)
  || :'
- bundle exec jekyll build
- bundle exec htmlproofer ./_site --check-html --check-favicon --allow-hash-href --external_only
  --only-4xx --http-status-ignore 429
after_success: s3_website push
notifications:
  slack:
    rooms:
      secure: Ft2JgY9CbFx/L/xOSH5saG61XqOHbRWh8av4rIOpCPN0Yj4usUolpYmzeS6gfMtYT1Qqp4eAdytx1/1Zs0cYGitm9SI5YBraBLBoYGTxYJrTuNeLoRj/3UytCm8daAcwRSLNnUqJFOr+Id3VdCcm6zS5RbQ5BJc/MqgVkR9ZGlH/oEVcHT4M3i7E+ogIjWG1OEpcwSBqGLqHX5Te6CSKQp4zXUCMo38RRmfHNo0lEzYtct21eCCai8CyS4kp0Qo333qM/VhlQYe16Oaz0vMSZQGi46nDJtS4Q0uQ+UH6batguge0LzxtHwum3a5/k59zgOM/V8ScZqT3piOOdq9n4kTGMY8Zji4g1MEuClv372oCutB7hNJCCF0nv0KYVtqOaiIUifM3X8xHT9fyo/4WRJsc7GNTrwtOG3fTzui7L7q70s21WGJSzvF6kHEZlbFQruC2jzHQXLE5MCg7iYuXy+ot5k3v5U1STsy7FxoOdXjYosZipcsaT91M/2Aj8m72VnRRLNwSfwkna/csZrWWu8XAXOWDg0b2sr5yTpddi/ywq8k4YynTlvInl/lKFnZ2n9jvmWFpzCsw1LZcUOZ4H9wC8CFrj2BGRUH8VwmuE6XiYoqfqiDz3btSOK7mpI316DLF7W+TTWNdQPwrVSffNpDlmB+U26IbZNI8LdJlEx4=
    on_success: always
